{"version":3,"file":"index-bl3BAxE_.js","sources":["../../src/components/utility/context-menu/index.vue"],"sourcesContent":["<template>\n  <div\n    v-if=\"isVisible\"\n    ref=\"contextmenu\"\n    :style=\"returnPosition()\"\n    @click.prevent.stop\n    class=\"bg-white dark:bg-zinc-900 z-[9999] shadow-sm rounded-xl border border-zinc-600/10 dark:border-zinc-800 p-3 fixed text-sm\"\n  >\n    <slot></slot>\n  </div>\n</template>\n\n<script setup>\nimport { ref, defineProps, nextTick, defineExpose } from \"vue\";\n\n// setup props\nconst props = defineProps({\n  teleport: {\n    type: Boolean,\n    required: false,\n    default: false,\n  },\n  offsetY: {\n    type: Number,\n    required: false,\n    default: 0,\n  },\n  offsetX: {\n    type: Number,\n    required: false,\n    default: 0,\n  },\n});\n\n// Setup refs\nconst isVisible = ref(false);\nconst contextmenu = ref(null);\nconst position = ref({\n  y: 0,\n  x: 0,\n});\n\n/**\n * Shows the context menu\n * evt (Object)\n * @since 0.0.1\n */\nconst show = async (evt, fixedPosition) => {\n  // Force a click event so other context menus will close\n  const event = new MouseEvent(\"click\", {\n    bubbles: true,\n    cancelable: true,\n    view: window,\n  });\n  document.dispatchEvent(event);\n\n  // Set pos\n  let pos = {\n    clientX: evt.clientX,\n    clientY: evt.clientY,\n  };\n\n  // Update pos if fixed position was passed\n  if (fixedPosition) {\n    pos = fixedPosition;\n  }\n\n  position.value.x = pos.clientX + props.offsetX;\n  position.value.y = pos.clientY + props.offsetY;\n  isVisible.value = true;\n\n  requestAnimationFrame(() => {\n    if (isVisible.value) {\n      setupClickOutside();\n      checkForOffScreen();\n    }\n  });\n};\n\n/**\n * Checks if context menu is offscreen\n * no args\n * @since 0.0.1\n */\nconst checkForOffScreen = () => {\n  let bounds = contextmenu.value.getBoundingClientRect();\n  let bottom = bounds.bottom;\n  let right = bounds.right;\n  let left = bounds.left;\n\n  if (bottom > window.innerHeight) {\n    position.value.y = position.value.y - (bottom - window.innerHeight) - 20;\n  }\n  if (right > window.innerWidth) {\n    position.value.x = position.value.x - (right - window.innerWidth) - 40;\n  }\n\n  if (left < 0) {\n    position.value.x = 32;\n  }\n};\n\n/**\n * Closes the context menu and removes the event listener\n * no args\n * @since 0.0.1\n */\nconst close = () => {\n  removeClickOutside();\n  isVisible.value = false;\n};\n\n/**\n * Closes the context menu and removes the event listener\n * no args\n * @since 0.0.1\n */\nconst isOpen = () => {\n  return isVisible.value;\n};\n\n/**\n * Mounts the click listener\n * no args\n * @since 0.0.1\n */\nconst setupClickOutside = () => {\n  document.addEventListener(\"click\", onClickOutside);\n  document.addEventListener(\"contextmenu\", onClickOutside);\n};\n\n/**\n * Removes the click listener\n * no args\n * @since 0.0.1\n */\nconst removeClickOutside = () => {\n  document.removeEventListener(\"click\", onClickOutside);\n  document.removeEventListener(\"contextmenu\", onClickOutside);\n};\n\n/**\n * Watches for clicks outside the context menu\n * evt (Object)\n * @since 0.0.1\n */\nconst onClickOutside = (event) => {\n  // It has already closed so remove watchers\n  if (!contextmenu.value) {\n    return close();\n  }\n  if (!contextmenu.value.contains(event.target)) {\n    return close();\n  }\n};\n\n/**\n * Returns the position for the context menu\n * no args\n * @since 0.0.1\n */\nconst returnPosition = () => {\n  let transform = \"\";\n  return `top: ${position.value.y}px; left: ${position.value.x}px;${transform}`;\n};\n\ndefineExpose({\n  show,\n  close,\n  isOpen,\n});\n</script>\n"],"names":["props","__props","isVisible","ref","contextmenu","position","show","evt","fixedPosition","event","pos","setupClickOutside","checkForOffScreen","bounds","bottom","right","left","close","removeClickOutside","isOpen","onClickOutside","returnPosition","__expose","_createElementBlock","_renderSlot","_ctx"],"mappings":"wQAgBA,MAAMA,EAAQC,EAmBRC,EAAYC,EAAI,EAAK,EACrBC,EAAcD,EAAI,IAAI,EACtBE,EAAWF,EAAI,CACnB,EAAG,EACH,EAAG,CAAA,CACJ,EAOKG,EAAO,MAAOC,EAAKC,IAAkB,CAEzC,MAAMC,EAAQ,IAAI,WAAW,QAAS,CACpC,QAAS,GACT,WAAY,GACZ,KAAM,MAAA,CACP,EACD,SAAS,cAAcA,CAAK,EAG5B,IAAIC,EAAM,CACR,QAASH,EAAI,QACb,QAASA,EAAI,OAAA,EAIXC,IACFE,EAAMF,GAGRH,EAAS,MAAM,EAAIK,EAAI,QAAUV,EAAM,QACvCK,EAAS,MAAM,EAAIK,EAAI,QAAUV,EAAM,QACvCE,EAAU,MAAQ,GAElB,sBAAsB,IAAM,CACtBA,EAAU,QACZS,EAAA,EACAC,EAAA,EACF,CACD,CAAA,EAQGA,EAAoB,IAAM,CAC9B,IAAIC,EAAST,EAAY,MAAM,sBAAA,EAC3BU,EAASD,EAAO,OAChBE,EAAQF,EAAO,MACfG,EAAOH,EAAO,KAEdC,EAAS,OAAO,cAClBT,EAAS,MAAM,EAAIA,EAAS,MAAM,GAAKS,EAAS,OAAO,aAAe,IAEpEC,EAAQ,OAAO,aACjBV,EAAS,MAAM,EAAIA,EAAS,MAAM,GAAKU,EAAQ,OAAO,YAAc,IAGlEC,EAAO,IACTX,EAAS,MAAM,EAAI,GACrB,EAQIY,EAAQ,IAAM,CAClBC,EAAA,EACAhB,EAAU,MAAQ,EAAA,EAQdiB,EAAS,IACNjB,EAAU,MAQbS,EAAoB,IAAM,CAC9B,SAAS,iBAAiB,QAASS,CAAc,EACjD,SAAS,iBAAiB,cAAeA,CAAc,CAAA,EAQnDF,EAAqB,IAAM,CAC/B,SAAS,oBAAoB,QAASE,CAAc,EACpD,SAAS,oBAAoB,cAAeA,CAAc,CAAA,EAQtDA,EAAkBX,GAAU,CAKhC,GAHI,CAACL,EAAY,OAGb,CAACA,EAAY,MAAM,SAASK,EAAM,MAAM,EAC1C,OAAOQ,EAAA,CACT,EAQII,EAAiB,IAEd,QAAQhB,EAAS,MAAM,CAAC,aAAaA,EAAS,MAAM,CAAC,MAG9D,OAAAiB,EAAa,CACX,KAAAhB,EACA,MAAAW,EACA,OAAAE,CAAA,CACD,SAxKSjB,EAAA,WADRqB,EAQM,MAAA,eANA,cAAJ,IAAInB,EACH,QAAOiB,GAAc,EACrB,sBAAD,IAAA,CAAA,EAAmB,CAAA,UAAA,MAAA,CAAA,GACnB,MAAM,0HAAA,GAENG,EAAaC,EAAA,OAAA,SAAA,CAAA"}